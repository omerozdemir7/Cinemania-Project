import{f as S,a as C,b as R,c as B,d as y,s as I}from"./api-Dh70rJD-.js";import{renderPagination as g,initPagination as k}from"./pagination-T5mrxBA8.js";import{Modal as v}from"./modal-BzXhaMjf.js";import{handleSearchPageChange as x}from"./searchbar-B2QQ2rJw.js";import"https://cdn.jsdelivr.net/npm/basiclightbox@5.0.4/+esm";const s={IMAGE_BASE_URL:"https://image.tmdb.org/t/p/w500",IMAGE_BASE_URL_2X:"https://image.tmdb.org/t/p/w780",BACKDROP_BASE_URL:"https://image.tmdb.org/t/p/w1280",BACKDROP_BASE_URL_2X:"https://image.tmdb.org/t/p/w1920",IMAGE_PLACEHOLDER:"/images/no-poster.svg"};let n,m=null;const d={lastSearch:{input:"",year:"",isSearch:!1},genresCache:[]};function T(e){return e?e.split("-")[0]:"—"}function b(e){return e?(window.devicePixelRatio>1?s.IMAGE_BASE_URL_2X:s.IMAGE_BASE_URL)+e:s.IMAGE_PLACEHOLDER}function U(e){if(!e)return s.IMAGE_PLACEHOLDER;const t=s.IMAGE_BASE_URL.replace("/w500","/w300")+e,i=s.IMAGE_BASE_URL+e;return`${t} 1x, ${i} 2x`}function P(e){return e?(window.devicePixelRatio>1?s.BACKDROP_BASE_URL_2X:s.BACKDROP_BASE_URL)+e:s.IMAGE_PLACEHOLDER}function E(e){const t=document.createElement("div");t.className="error-message error",t.textContent=e,t.style.cssText="position:fixed;top:20px;right:20px;background:rgba(0,0,0,.9);color:#fff;padding:16px 24px;border-radius:12px;z-index:10000;box-shadow:0 8px 32px rgba(0,0,0,.5);",document.body.appendChild(t),setTimeout(()=>t.remove(),4e3)}function A(e,t){if(!t)return;const i=(e||0)/2,r=Math.floor(i),l=i-r>=.5,c=5-r-(l?1:0);let a="";for(let o=0;o<r;o++)a+='<svg class="catalog-icon movie-card__icon--star"><use xlink:href="/images/symbol-defs.svg#icon-star"></use></svg>';l&&(a+='<svg class="catalog-icon movie-card__icon--star-half"><use xlink:href="/images/symbol-defs.svg#icon-star-half"></use></svg>');for(let o=0;o<c;o++)a+='<svg class="catalog-icon movie-card__icon--star-empty"><use xlink:href="/images/symbol-defs.svg#icon-star-empty"></use></svg>';t.innerHTML=a}function L(e){const t=document.getElementById("hero");if(!t||!n.heroContent)return;const i=e.backdrop_path?P(e.backdrop_path):b(e.poster_path),r=new Image;r.onload=function(){t.style.backgroundImage=`url('${i}')`,t.style.backgroundSize="cover",t.style.backgroundPosition="center",t.style.backgroundRepeat="no-repeat",t.style.backgroundAttachment="fixed",t.style.transition="background-image .3s ease"},r.src=i,n.heroContent.innerHTML=`
    <div class="hero-info">
      <h2 class="hero-title">${e.title}</h2>
      <div class="rating-stars" id="hero-rating-stars"></div>
      <p class="hero-overview">${e.overview||"No overview available."}</p>
      <div class="hero-actions">
        <button class="btn trailer-btn" data-id="${e.id}">Watch trailer</button>
        <button class="btn details-btn" data-id="${e.id}">More details</button>
      </div>
    </div>`,A(e.vote_average||0,document.getElementById("hero-rating-stars"))}function f(e){if(n.moviesUl.innerHTML="",!e||e.length===0){G();return}z();const t=document.createDocumentFragment();e.forEach(i=>t.appendChild(D(i))),n.moviesUl.appendChild(t)}function D(e){var c,a;const t=document.createElement("li");t.className="movie-card",t.dataset.id=e.id,t.style.cursor="pointer";let i="";(c=e.genres)!=null&&c.length?i=e.genres.map(o=>o.name).join(", "):(a=e.genre_ids)!=null&&a.length&&(i=e.genre_ids.map(M=>{var p;return((p=d.genresCache.find(w=>w.id===M))==null?void 0:p.name)||""}).filter(Boolean).slice(0,2).join(", "));const r=T(e.release_date),l=i?`${i} | ${r}`:r;return t.innerHTML=`
    <div class="movie-card__poster">
      <img src="${b(e.poster_path)}" alt="${e.title} poster"
           loading="lazy" srcset="${U(e.poster_path)}" />
    </div>
    <div class="movie-card__info">
      <div class="movie-card__info-left">
        <div class="movie-card__title">${e.title}</div>
        <div class="movie-card__meta">${l}</div>
      </div>
      <div class="movie-card__info-right">
        <div class="movie-card__rating"></div>
      </div>
    </div>`,A(e.vote_average||0,t.querySelector(".movie-card__rating")),t}function u(e){n.emptyEl&&(n.moviesUl.innerHTML="",g(0,0),n.emptyEl.innerHTML=`
    <div class="l1" style="color: #ff4545;">API Hatası</div>
    <div class="l1">${e}</div>
    <div class="l1">Lütfen API anahtarınızı kontrol edin.</div>`,n.emptyEl.classList.add("is-visible"),n.emptyEl.removeAttribute("hidden"))}window.renderMoviesList=f;window.renderPagination=g;async function h(e=1){var t;try{n.movieListRegion.setAttribute("aria-busy","true");const i=await R(e);if((i==null?void 0:i.success)===!1){u(i.status_message||"Bilinmeyen bir API hatası oluştu.");return}if(n.heroContent&&e===1){const r=(t=i.results)==null?void 0:t[0];r&&L(r)}f(i.results||[]),g(e,i.total_pages||1),d.lastSearch={input:"",year:"",isSearch:!1}}catch(i){console.error("Error loading trending movies:",i),u("Trend filmler yüklenemedi. İnternet bağlantınızı kontrol edin.")}finally{n.movieListRegion.removeAttribute("aria-busy")}}async function H(e,t="",i=1){if(!e||e.trim()==="")return h();try{n.movieListRegion.setAttribute("aria-busy","true");const r=await I(e.trim(),t,i);if((r==null?void 0:r.success)===!1){u(r.status_message||"Arama sırasında bilinmeyen bir API hatası oluştu.");return}f(r.results||[]),g(i,r.total_pages||1),d.lastSearch={input:e,year:t,isSearch:!0}}catch(r){console.error("Error performing search:",r),u("Arama başarısız oldu. İnternet bağlantınızı kontrol edin.")}finally{n.movieListRegion.removeAttribute("aria-busy")}}async function $(e){if(await x(e)){window.scrollTo({top:0,behavior:"smooth"});return}d.lastSearch.isSearch?H(d.lastSearch.input,d.lastSearch.year,e):h(e),window.scrollTo({top:0,behavior:"smooth"})}function O(){m&&n.moviesUl.removeEventListener("click",m),m=async e=>{const t=e.target.closest(".movie-card");if(!t)return;const i=t.dataset.id;if(i)try{const r=await y(i);v.renderMovie(r)}catch(r){console.error("Modal open error:",r)}},n.moviesUl.addEventListener("click",m),document.addEventListener("click",async e=>{var r;const t=e.target.closest(".trailer-btn");if(t){const c=(r=(await B(t.dataset.id)).results)==null?void 0:r.find(a=>a.type==="Trailer"&&a.site==="YouTube");c?v.showTrailer(c.key):E("Trailer not available.");return}const i=e.target.closest(".details-btn");if(i){const l=await y(i.dataset.id);v.renderMovie(l)}})}async function _(){var e;try{n={moviesUl:document.getElementById("movies-ul"),heroContent:document.getElementById("hero-content"),movieListRegion:document.getElementById("movie-list"),emptyEl:document.getElementById("catalog-empty")},O(),k($);const t=await S();if(d.genresCache=t.genres||[],n.heroContent){const r=(e=(await C()).results)==null?void 0:e[0];r&&L(r)}await h(1)}catch(t){console.error("initialize error:",t),E("Failed to initialize application.")}}function G(){n.emptyEl&&(n.emptyEl.innerHTML=`
    <div class="l1">OOPS...</div>
    <div class="l1">We are very sorry!</div>
    <div class="l1">We don’t have any results matching your search.</div>`,n.emptyEl.classList.add("is-visible"),n.emptyEl.removeAttribute("hidden"))}function z(){n.emptyEl&&(n.emptyEl.classList.remove("is-visible"),n.emptyEl.setAttribute("hidden",""),n.emptyEl.innerHTML="")}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",_):_();
//# sourceMappingURL=catalog-mkH3AbD6.js.map
