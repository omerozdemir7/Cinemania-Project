{"version":3,"file":"weekly-B9Ue1KgA.js","sources":["../../src/components/weekly/weekly.js"],"sourcesContent":["import { fetchWeeklyMovies, fetchMovieDetails, fetchGenres } from '../../services/api.js';\n\nimport { Modal } from '../modal/modal.js';\n\nlet gallery;\nlet seeAllBtn;\nlet allMovies = [];\nlet isExpanded = false;\n\nfunction getVisibleCardCount() {\n  const width = window.innerWidth;\n  if (width < 768) return 1;\n  if (width < 1280) return 3;\n  return 3;\n}\nfunction createRatingStars(vote) {\n  const fullStars = Math.floor(vote / 2);\n  const hasHalfStar = vote % 2 >= 1;\n  const emptyStars = 5 - fullStars - (hasHalfStar ? 1 : 0);\n  let stars = [];\n  for (let i = 0; i < fullStars; i++)\n    stars.push(\n      '<svg class=\"weekly__icon--full-star\"><use xlink:href=\"/images/icon.svg#icon-full-star\"></use></svg>'\n    );\n  if (hasHalfStar)\n    stars.push(\n      '<svg class=\"weekly__icon--half-star\"><use xlink:href=\"/images/icon.svg#icon-half-star\"></use></svg>'\n    );\n  for (let i = 0; i < emptyStars; i++)\n    stars.push(\n      '<svg class=\"weekly__icon--empty-star\"><use xlink:href=\"/images/icon.svg#icon-empty-star\"></use></svg>'\n    );\n  return stars.join('');\n}\nasync function renderWeeklyTrends(limit = getVisibleCardCount()) {\n  try {\n    const [trendData, genreData] = await Promise.all([\n      fetchWeeklyMovies(),\n      fetchGenres(),\n    ]);\n    allMovies = trendData.results;\n    const genreMap = genreData.genres.reduce((acc, genre) => {\n      acc[genre.id] = genre.name;\n      return acc;\n    }, {});\n    const moviesToShow = allMovies.slice(0, limit);\n    const markup = moviesToShow\n      .map(movie => {\n        const posterUrl = movie.poster_path\n          ? `https://image.tmdb.org/t/p/w500${movie.poster_path}`\n          : `https://via.placeholder.com/500x750?text=No+Image`;\n        const genreName = movie.genre_ids\n          .map(id => genreMap[id])\n          .slice(0, 1)\n          .join(', ');\n        const year = movie.release_date\n          ? movie.release_date.slice(0, 4)\n          : 'N/A';\n        const ratingStars = createRatingStars(movie.vote_average);\n        return `\n          <li class=\"weekly__card\" data-id=\"${movie.id}\">\n            <div class=\"poster-wrapper\">\n              <img class=\"weekly__card-img\" src=\"${posterUrl}\" alt=\"${movie.title}\" />\n              <div class=\"weekly__card-overlay\">\n                <h3 class=\"weekly__card-title\">${movie.title.toUpperCase()}</h3>\n                <p class=\"weekly__card-info\">${genreName} | ${year}</p>\n                <div class=\"weekly__card-rating\">${ratingStars}</div>\n              </div>\n            </div>\n          </li>\n        `;\n      })\n      .join('');\n    gallery.innerHTML = markup;\n  } catch (err) {\n    console.error('Weekly trends fetch error:', err);\n    gallery.innerHTML = '<p>Veriler alınamadı.</p>';\n  }\n}\nfunction initWeeklySection() {\n  gallery = document.querySelector('.weekly__gallery');\n  seeAllBtn = document.querySelector('.weekly__see-all');\n  if (!gallery || !seeAllBtn) {\n    console.warn('weekly-gallery veya see-all bulunamadı.');\n    return;\n  }\n  seeAllBtn.addEventListener('click', () => {\n    isExpanded = !isExpanded;\n    const count = isExpanded ? allMovies.length : getVisibleCardCount();\n    renderWeeklyTrends(count);\n  });\n  gallery.addEventListener('click', async e => {\n    const card = e.target.closest('.weekly__card');\n    if (!card) return;\n    const movieId = card.dataset.id;\n    try {\n      const movie = await fetchMovieDetails(movieId);\n      Modal.renderMovie(movie); // <-- generic modal\n    } catch (err) {\n      console.error('Popup açılırken hata:', err);\n    }\n  });\n  renderWeeklyTrends();\n}\nif (document.readyState === 'loading') {\n  document.addEventListener('DOMContentLoaded', initWeeklySection, {\n    once: true,\n  });\n} else {\n  initWeeklySection();\n}"],"names":["gallery","seeAllBtn","allMovies","isExpanded","getVisibleCardCount","width","createRatingStars","vote","fullStars","hasHalfStar","emptyStars","stars","i","renderWeeklyTrends","limit","trendData","genreData","fetchWeeklyMovies","fetchGenres","genreMap","acc","genre","markup","movie","posterUrl","genreName","id","year","ratingStars","err","initWeeklySection","count","e","card","movieId","fetchMovieDetails","Modal"],"mappings":"8JAIA,IAAIA,EACAC,EACAC,EAAY,CAAA,EACZC,EAAa,GAEjB,SAASC,GAAsB,CAC7B,MAAMC,EAAQ,OAAO,WACrB,OAAIA,EAAQ,IAAY,GACpBA,EAAQ,KAAa,EAE3B,CACA,SAASC,EAAkBC,EAAM,CAC/B,MAAMC,EAAY,KAAK,MAAMD,EAAO,CAAC,EAC/BE,EAAcF,EAAO,GAAK,EAC1BG,EAAa,EAAIF,GAAaC,EAAc,EAAI,GACtD,IAAIE,EAAQ,CAAA,EACZ,QAASC,EAAI,EAAGA,EAAIJ,EAAWI,IAC7BD,EAAM,KACJ,qGACN,EACMF,GACFE,EAAM,KACJ,qGACN,EACE,QAASC,EAAI,EAAGA,EAAIF,EAAYE,IAC9BD,EAAM,KACJ,uGACN,EACE,OAAOA,EAAM,KAAK,EAAE,CACtB,CACA,eAAeE,EAAmBC,EAAQV,IAAuB,CAC/D,GAAI,CACF,KAAM,CAACW,EAAWC,CAAS,EAAI,MAAM,QAAQ,IAAI,CAC/CC,EAAmB,EACnBC,EAAa,CACnB,CAAK,EACDhB,EAAYa,EAAU,QACtB,MAAMI,EAAWH,EAAU,OAAO,OAAO,CAACI,EAAKC,KAC7CD,EAAIC,EAAM,EAAE,EAAIA,EAAM,KACfD,GACN,CAAE,CAAA,EAECE,EADepB,EAAU,MAAM,EAAGY,CAAK,EAE1C,IAAIS,GAAS,CACZ,MAAMC,EAAYD,EAAM,YACpB,kCAAkCA,EAAM,WAAW,GACnD,oDACEE,EAAYF,EAAM,UACrB,IAAIG,GAAMP,EAASO,CAAE,CAAC,EACtB,MAAM,EAAG,CAAC,EACV,KAAK,IAAI,EACNC,EAAOJ,EAAM,aACfA,EAAM,aAAa,MAAM,EAAG,CAAC,EAC7B,MACEK,EAActB,EAAkBiB,EAAM,YAAY,EACxD,MAAO;AAAA,8CAC+BA,EAAM,EAAE;AAAA;AAAA,mDAEHC,CAAS,UAAUD,EAAM,KAAK;AAAA;AAAA,iDAEhCA,EAAM,MAAM,aAAa;AAAA,+CAC3BE,CAAS,MAAME,CAAI;AAAA,mDACfC,CAAW;AAAA;AAAA;AAAA;AAAA,SAK9D,CAAO,EACA,KAAK,EAAE,EACV5B,EAAQ,UAAYsB,CACrB,OAAQO,EAAK,CACZ,QAAQ,MAAM,6BAA8BA,CAAG,EAC/C7B,EAAQ,UAAY,2BACrB,CACH,CACA,SAAS8B,GAAoB,CAG3B,GAFA9B,EAAU,SAAS,cAAc,kBAAkB,EACnDC,EAAY,SAAS,cAAc,kBAAkB,EACjD,CAACD,GAAW,CAACC,EAAW,CAC1B,QAAQ,KAAK,yCAAyC,EACtD,MACD,CACDA,EAAU,iBAAiB,QAAS,IAAM,CACxCE,EAAa,CAACA,EACd,MAAM4B,EAAQ5B,EAAaD,EAAU,OAASE,EAAmB,EACjES,EAAmBkB,CAAK,CAC5B,CAAG,EACD/B,EAAQ,iBAAiB,QAAS,MAAMgC,GAAK,CAC3C,MAAMC,EAAOD,EAAE,OAAO,QAAQ,eAAe,EAC7C,GAAI,CAACC,EAAM,OACX,MAAMC,EAAUD,EAAK,QAAQ,GAC7B,GAAI,CACF,MAAMV,EAAQ,MAAMY,EAAkBD,CAAO,EAC7CE,EAAM,YAAYb,CAAK,CACxB,OAAQM,EAAK,CACZ,QAAQ,MAAM,wBAAyBA,CAAG,CAC3C,CACL,CAAG,EACDhB,GACF,CACI,SAAS,aAAe,UAC1B,SAAS,iBAAiB,mBAAoBiB,EAAmB,CAC/D,KAAM,EACV,CAAG,EAEDA"}